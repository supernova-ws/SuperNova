Stay out of my shed

Сжимать счётчик

Собирать статистику по онлайну игроков по дням каждый маинтенанс. Подумать какую (см. ToDo)

История отпусков
Динамический срок отпуска - vacation_history

Антишпионская сеть - на время, за ТМ? Сбивает всех шпионов, так что игрок не получает инфы о планете



XXX:
"боеприпас повышенного могущества". Это нормальный термин?
YYY:
Это артиллерийский термин. Там боеприпасы разделяются по могуществу, властности и блистательности.
ZZZ:
Есть еще градация по напыщенности и ослепительности


There is not really much difference between the three.
gzencode() uses the fully self-contained gzip format, same as the gzip command line tool
    gzdecode() is defined only for PHP 5.4.0 or newer
    gzencode() - is OK
gzcompress() uses the raw ZLIB format. It is similar to gzencode but with less header data, etc. I think it was intended for streaming.
gzdeflate() uses the raw DEFLATE algorithm on its own, which is the basis for both the other formats.

basically gzcompress follows rfc1951 which contains a bunch of other data along with the compressed data that is used when decompressing. It includes an ADLER32 checksum, compression level, compression method, dictionary, the compressed data, and a bunch of other data used to decompress the data.
gzdeflate is rfc1950 which is only the compression data.
gzcompress is probably better to use, as it can verify the integrity of the data, and is more portable.

NOT gzencode
gzdefalte() !

This is what PHP functions return:
gzencode() == gzip
gzcompress() == zlib (aka. HTTP deflate)
gzdeflate()  == *raw* deflate encoding

Светить ДР в Императоре?


http://pouchdb.com/learn.html - PouchDB is an in-browser database that allows applications to save data locally, so that users can enjoy all the features of an app even when they're offline. Plus, the data is synchronized between clients, so users can stay up-to-date wherever they go.
http://nparashuram.com/IndexedDBShim/ - IndexedDB Polyfill over WebSql


Админка по ивенту:
SELECT username, game_unit.* FROM `game_unit`
left join game_users on id = unit_player_id
where unit_type = 3001 and unit_snid = 3002;

select unit_snid, sum(unit_level) as count from game_unit
where unit_type = 3001 group by unit_snid;

select unit_snid, sum(unit_level) as count from game_unit
where unit_type = 3001 ;

happening

Враппер для добавления методов в рилтайме
class stdObject {
    public function __call($method, $arguments) {
        return call_user_func_array(Closure::bind($this->$method, $this, get_called_class()), $arguments);
    }
}

$obj = new stdObject();
$obj->test = function() {
    echo "<pre>" . print_r($this, true) . "</pre>";
};
$obj->test();


<?php
trait DynamicDefinition {

    public function __call($name, $args) {
        if (is_callable($this->$name)) {
            return call_user_func($this->$name, $args);
        }
        else {
            throw new \RuntimeException("Method {$name} does not exist");
        }
    }

    public function __set($name, $value) {
        $this->$name = is_callable($value)?
            $value->bindTo($this, $this):
            $value;
    }
}

class Foo {
    use DynamicDefinition;
    private $privateValue = 'I am private';
}

$foo = new Foo;
$foo->bar = function() {
    return $this->privateValue;
};

// prints 'I am private'
print $foo->bar();

?>


Рандомизатор онлайна активности
  update lh_users set onlinetime = UNIX_TIMESTAMP() - FLOOR(1 + RAND() * (30 - 1)) * 24*60*60 ;

Ивент "Черная Луна"
  - вбрасывается несколько планет с лунами от нескольких пользователй разных уровней для разных интервалов
  - каждая луна генерит ТМ. Каждая луна - своё количество
  - пока на планете стоит чужой флот - ТМ капает на этого игрока
  - если флотов несколько - ТМ распределяется между всеми игроками пропорционально цене флота
  - обсчет ЧЛ происходит каждые 10 минут
  - виртуальный игрок имеет две планеты. Первую - столицу, вторую - с ЧЛ. Столица обязательно появляется в населенном секторе (активный игрок), а ЧЛ - в ненаселенном (i-шки или пустые?)
    $user_activity = floor((SN_TIME_NOW - $uni_galaxyRowUser['onlinetime'])/(60*60*24));
     'USER_ACTIVITY' => $user_activity,
     'USER_ATTACKABLE' => $user_activity >= 7,
     'USER_INACTIVE' => $user_activity >= 28,
  - посмотреть - можно ли просто поставить пользователю статистику и она будет сохранятся между пересчетами, или надо хитровыебаться
  - (???) частота тиков, максимальная длительность Удержания и количество флотов зависит от брэкета, для которого стоит ЧЛ
  - несколько лун для маленьких брэкетов


select u.id, u.onlinetime, UNIX_TIMESTAMP(NOW()),
IF((UNIX_TIMESTAMP(NOW()) - u.onlinetime)/24/60/60 < 7, 0,
IF((UNIX_TIMESTAMP(NOW()) - u.onlinetime)/24/60/60 < 28, 1, 2))
from lh_planets as p
join lh_users as u on u.id = p.id_owner
order by u.id
limit 1000;



Эксперимент по краудфандингу: ивент "Черная Луна"

В чате на Альфе предложили ивент. Как предложили, конечно, слабореализуемый бред, но, как ни странно, идея имеет здравое зерно. Оригинал звучал так:
[quote]"[07.12.2014 23:22:58]  Spirt> я тут подсмотрел идейку, в общем ивент. Его суть: Администрация создаёт 1 плантку которую можно захватывать, с неё можно добывать ТМ, и сообщает кординаты этой планетки всем присутствующим. Альянсы воюют за эту планету)"[/quote]
Очевидно, что это - слабореализуемая утопия. Конечно, в планах есть и захват планет, и Бои Альянсов, но каждый из этих компонентов сам по себе требует немало времени на реализацию. А затем это всё надо скомпоновать и сделать ивент сам по себе - что тоже потребует некислых модификаций кода. Например - добавление структуры, которая добывает ТМ. Напомню, что сейчас такие структуры в движке в принципе не предусмотрены, т.е. их надо писать с нуля  В общем - работы на многие десятки часов

Но в том же чате в очередной раз предложили "скинутся"... Что ж, я давно вынашиваю идею краудфандинга фишек. Ибо хочется больше времени уделять движку, но и кушать что-то надо. Давайте проведем эксперимент. Как знать - может соберется и с миру Горлуму на пиво? И, возможно, это станет хорошей традицией - подкреплять свои "хотелки" баблом, а не просто кидая их в чат

Объявляю краудфандинг на фишку "ивент 'Черная Луна'". Краудфандинг - это когда много людей жертвует на проект некую сумму, а в результате общий итог (в идеале) дает разработчику возможность воплотить фишку в коде и запустить её в игру

Немного по сути ивента. Он состоит в том, что во Вселенную вбрасывается планеты, которые имеют особенную луну - Чёрную Луну (ЧЛ). При установке флота в Удержание на ЧЛ, игроку каждый тик будет капать ТМ.

И немного технических деталей:
- в каждом брэкете (диапазоны разбиения игроков в зависимости от их баллов развития) будет собственная ЧЛ. Т.е. игроки всех уровней смогут поучаствовать в ивенте. Кроме, возможно, топов - там слишком узкие брэкеты, так что на каждого топа может прийтись по ЧЛ. Что лишает интригу смысла
- установка флота в Удержание на ЧЛ приносит владельцу флота ТМ каждый тик
- если в Удержании стоит 1 флот любого размера - всю ТМ получает владелец флота
- если в удержании стоит несколько флотов - ТМ распределяется по владельцам пропорционально полным стоимостям флотов (т.е. включая стоимость в дейтерии)
- ЧЛ можно уничтожить

Я уже составил на ТЗ на этот ивент, посчитал вчерне математику и готов его реализовать. Теперь дело за игроками. Как это принято в краудфандинге, установим цели:[list]
[*] <100 USD в эквиваленте - эксперимент будет признан провальным. Все "хотельщики", чьи хотелки не подкреплены конкретной суммой будут отправляться в пешее эротическое, вместе со своими хотелками. Если не наберется даже 100 USD, то всем, кто проспонсирует эту фишку, в компенсацию за пассивность остальных игроков будет начислен эквивалент суммы в ММ на любом выбранном ими сервере supernova.ws (это верно ТОЛЬКО ЕСЛИ не наберется даже 100 USD в эквиваленте);
[*] >=100 USD в эквиваленте - результат эксперимента - удовлетворительный. Я сделаю эту фишку в базовом варианте и она будет выпущена в рамках новогодней акции к Новому Году-2015;
[*] >=200 USD в эквиваленте - результат эксперимента - хороший. Примерно в такую сумму я оцениваю базовый функционал этого ивента для СН[list]
    [*] Каждый пожертвованный доллар после 200 USD будет увеличивать добычу с ЧЛ во время новогодней акции на 1%. Т.е. 250 USD - +50% от запланированной скорости добычи;[/list]
[*] >=300 USD в эквиваленте - результат эксперимента - очень хороший[list]
    [*] Каждый пожертвованный доллар после 200 USD будет увеличивать добычу с ЧЛ во время новогодней акции на 2%. Т.е. 350 USD - +300% от запланированной скорости добычи;
    [*] Все, кто спонсировал фишку, получат 5% в виде ТМ на любом игровом сервере supernova.ws (это и подобные предложения распространяются и на игроков из приложений под Андроид, Windows и Windows Phone);[/list]
[*] >=400 USD в эквиваленте - результат эксперимента - отличный![list]
    [*] После НГ в игру на постоянно основе будет добавлена дорогая лунная спецпостройка, которая будет фармить ТМ на Луне (будут ограничения и допусловия на работу этой постройки!);
    [*] Каждый пожертвованный доллар после 200 USD будет увеличивать добычу с ЧЛ во время новогодней акции на 4%. Т.е. 450 USD - +1000% от запланированной скорости добычи
    [*] Все, кто спонсировал фишку, получат 10% в виде ТМ на любом игровом сервере supernova.ws;[/list]
[*] >=500 USD в эквиваленте - результат эксперимента - великолепный!! Примерно столько стоил бы базовый функционал (без зданий, свистелок и перделок), если бы пришлось заказывать его "на стороне". Это даст возможность мне написать дополнительный интерфейс и сделать такие ивенты РЕГУЛЯРНЫМИ![list]
    [*] Ивент станет РЕГУЛЯРНЫМ!
    [*] В Новый Год гарантированно будет скидка на покупку ММ
    [*] После НГ в игру на постоянно основе будет добавлена дорогая лунная спецпостройка, которая будет фармить ТМ на Луне (часть ограничений будет снято, добыча будет увеличена)
    [*] Каждый пожертвованный доллар после 200 USD будет увеличивать добычу с ЧЛ во время новогодней акции на 10%. Т.е. 550 USD - +3500% от запланированной скорости добычи
    [*] Все, кто спонсировал фишку, получат 25% в виде ТМ на любом игровом сервере supernova.ws;[/list][/list]


Естественно, предусмотрены индивидуальные бонусы! Они начисляются тем, чья сумма пожертвования достигла указанной величины в дополнение к тем бонусам, которые начислены при достижении общей цели:[list]
[*] 50 USD - Премиум-аккаунт +3 на 3 месяца на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Бронзовый спонсор". +10% к следующей покупке ММ на любом сервере
[*] 100 USD - Премиум-аккаунт +3 на 6 месяцев на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Серебряный спонсор". +20% к следующей покупке ММ на любом сервере
[*] 200 USD - Премиум-аккаунт +4 на 3 месяца на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Золотой спонсор". +30% к следующей покупке ММ на любом сервере
[*] 300 USD - Премиум-аккаунт +4 на 1 год на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Платиновый спонсор". +50% к следующей покупке ММ на любом сервере
[*] 500 USD - Премиум-аккаунт +5 на 3 месяца, максимальный уровень всех Наемников на 1 год на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Алмазный спонсор". +75% ММ к следующей покупке на любом сервере
[*] 1000 USD - Премиум-аккаунт +5 на 6 месяцев, максимальный уровень всех Наемников +1 на 1 год на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Бриллиантовый спонсор". +100% ММ к следующей покупке на любом сервере
[*] 2000 USD - Премиум-аккаунт +5 на 1 год, максимальный уровень всех Наемников +2 на 1 год на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Тёмный спонсор". Выделение имени игрока в чате. +150% ММ к следующей покупке на любом сервере
[*] 5000 USD - Премиум-аккаунт +6 на 1 год, максимальный уровень всех Наемников +5 на 1 год на ЛЮБОМ из серверов Альфа, Бета, Гамма, Дельта. Игровая медаль "Метаспонсор". Выделение имени игрока в чате. +300% ММ к следующей покупке на любом сервере[/list]

Если платежи разнесены во времени - то награды всё равно кумулятивны. Т.е. если кто-то пожертвовал 50 WMZ и получил +3 премиум на 3 месяца, а затем пожертвовал еще 50 WMZ - его премиум будет проапгрейжен с 3 месяцев до 6 месяцев. Ну и никто не мешает проапгрейдить свой прем на любой другой уровень

Подчеркиваю: данное предложение - это не акция. Это - сбор средств на новую фишку. Основная цель - собрать деньги на фишку. Бонусы - это чисто бонусы. Тупо купить ММ за ту же сумму будет дешевле. Но участие в сборе средств даст мне понимание, насколько игроки ДЕЙСТВИТЕЛЬНО заинтересованы в игре и насколько имеет смысл обращать на их хотелки

Первоначальный контрольный срок - среда, 10 декабря 2015 года. Там станет понятно - стоит ли продолжать краудфандинг

Для получения реквизитов для платежа со мной можно связаться по контактам, указанным тут: http://forum.supernova.ws/viewtopic.php?f=3&t=2474



Итак, на СуперНове начали отмечать Новогодние праздники. Первые залпы феерверка акций и ивентов игроки уже почувствовали на себе:[list]
[*] Новогодний фон
[*] Новогодний набор смайликов
[*] И самое интересное - увеличение рейтов добычи ресурсов в 1,5 раза![/list]

Но это - только начало! Что бы игроки ориентировались в грядущем разгуле, публикуется очень кратенькая выжимка запланированных на НГ мероприятий:[list]
[*] 24 декабря 2014 года - 18 января 2015 года 23:59:59: Новогодние Праздники на СуперНове!
[*] 24 декабря 2014 года: скорость добычы увеличивается в 1,5 раза. [color=#008000]УЖЕ В СУПЕРНОВЕ![/color]
[*] 24 декабря 2014 года - 1 января 2015 года 23:59:59: МЕГАскидки на премиум-аккаунты ЗА ТМ! (см. ниже)
[*] 25 декабря 2014 года: скорости постройки и исследований увеличиваются в 1,5 раза
[*] ?? декабря 2014 года - 31 декабря 2014 года: (тут ЕЩЕ МОЖЕТ быть ивент, если до 28 декабря наберется 500 эквивалентов на [url=http://forum.supernova.ws/viewtopic.php?f=4&t=2981&start=10#p35948]ЧЛ[/url]
[*] 31 декабря 2014 года - 1 января 2015 года 23:59:59: [url=http://forum.supernova.ws/viewtopic.php?f=4&t=2987]мораторий[/url] на агрессивные миссии
[*] Новогодняя Ночь - отмечаем Новый Год в чате СН! На время моратория (включая Новогоднюю Ночь) будет снято ограничение на неигровые разговоры в чате. Однако помним - нарушать Правила по-прежнему нельзя: никаких обсуждений политики, религии, личных данных игроков и прочего
[*] 2 января 2015 года 00:00:00 - в честь 55-летия первого полёта Человечества к Луне - ивент "Восхождение [url=http://forum.supernova.ws/viewtopic.php?f=4&t=2981]Чёрной Луны[/url]". Окончание ивента - [color=#800000]6 января 2015 года 23:59:59[/color]
[*] ?? декабря 2014 года - 31 декабря 2014 года: (тут ЕЩЕ МОЖЕТ быть ивент, если до 28 декабря наберется 500 эквивалентов на [url=http://forum.supernova.ws/viewtopic.php?f=4&t=2981&start=10#p35948]ЧЛ[/url]
[*] ?? января 2015 года: (тут ЕЩЕ МОЖЕТ появится [url=http://forum.supernova.ws/viewtopic.php?f=4&t=2981&start=10#p35948]спецпостройка для лун[/url], которая будет фармить ТМ, если наберется 500 эквивалентов на ивент ЧЛ)
[*] 18 января 2015 года 23:59:59: Окончание Новогодних Праздников. Заканчиваются все ивенты, акции. Рейты возвращаются к изначальным уровням
[/list]

В распиании событий указаны скидки на Премиум-аккаунт! И они УЖЕ В ИГРЕ! Скидки - на любой вкус и любое количество ТМ! Да-да, вы не ослышались! В Новогодние Праздники скидки на Премиум-аккаунт даются просто за ТМ! Скидки от приятных 2% до огромных 60%!
Уже на +3 премиуме за до-акционную цену 60 дней можно теперь взять тот же самый уровень премиума на 90 дней - месяц премиума в подарок!
Дальше - больше! 60 дневный Премиум +4 сейчас лишь чуточку дороже, чем раньше стоил 30 дневный аккаунт того же уровня! Двухкратная длительность - по практически той же цене!
Хочется ЕЩЕ больше? Есть их у меня! Месячный прем +5 - дешевле, чем доакционный двухнедельный прем! А +6 уровень отдается практически даром - 90 дней премиума стоят дешевле, чем 30 дней до Новогодних Праздников! Два месяца мощнейшего премиума - в подарок!
Впрочем, все детали вы можете посмотреть сами - как писалось выше, скидки УЖЕ В ИГРЕ! Лишь выберите пункт "Премиум" в меню слева - и сами выбирайте себе скидку!



Экспедиции - левел должен влиять на что-то. На добычу?

http://habrahabr.ru/post/244815/
  Оптимизация CSS - комменты
  http://perfectionkills.com/profiling-css-for-fun-and-profit-optimization-notes/
http://perfectionkills.com/profiling-css-for-fun-and-profit-optimization-notes/
http://frontender.info/css-performance-revisited-selectors-bloat-expensive-styles/




Мой ник Сингулярность на серверах:
http://alpha.supernova.ws/ (он же http://ogame.supernova.ws/ , на том же сервере играют все игроки через приложения Андроид, Windows 8 и Windows Phone)
http://delta.supernova.ws/

Мой ник Gorlum на серверах:
http://gamma.supernova.ws/ (он же http://supernova.supernova.ws/ )
http://beta.supernova.ws/





Новое здание - Монолит (Одиссея-2001)
  - строится за ресы и ТМ (или только за ресы, но огромное количество?)
  - генерит ТМ
  - работает, только если на планете нет других построек и обороны, а на орбите - нет флотов


Новое здание - "Голограмный проектор" за ТМ. Показывает в шпионаже увеличенное количество юнитов на планете. Режимы работы:
  - Отключить
  - Уменьшение уровней всех зданий
  - Уменьшение количество боевых юнитов (раздельно защиты и обороны?)
  - Увеличение количества боевых юнитов (раздельно защиты и обороны?)
  - Спрятать полностью одно здание - тогда видно проектор. В случае если это шахты - прячет и ракеты. Можно спрятать здания на сумму своих уровней, на себя - прячет свой остаток
  - Работать в + к ЭУИ планеты
  - От уровня зависит доступное изменение. Каждый уровень - +10% (5%?)
  - Прячет ли себя в режимах работы?


Телепортация, использование Крюка и БАК, использование Монолита, использование Ворот - увеличивает шанс превращения солнца системы в СуперНову. Как в исходнике, так и в пункте Назначения
Эвент СуперНова
  - есть время убраться, телепортироваться и продаться
  - при телепорта заново кидается шанс СуперНовы
  - Телепорт - +1%, Ворота - +0.1%, Монолит - +0.001% (?) за левел каждый тик. Тик - каждые 60 минут
  - при взрыве СН сносится % зданий, флота и обороны, равный проценту шанса взрыва с округлением вверх


Планировщик бюджета ТМ

Китайсы
  http://habrahabr.ru/post/237725/
  http://habrahabr.ru/post/245027/

  Я использовал вот этот сервис tethras.com. Переводил приложение для windows phone, у меня было около 600-100 слов, кажется. Примерно вышло около $50 за один язык. Кстати там очень удобно сразу загружаешь ресурсный фаил и получаешь так же ресурсный фаил, но уже в другом языке.

  если заказ разовый и объём небольшой, то можно воспользоваться сервисами типа Gengo или Alconost Nitro. По обеим ссылкам есть расценки. Если же проект подразумевает постоянные обновления и развитие, то лучше найти переводческое агентство (лучше в самом Китае). Расценки агентств (в паре английский-китайский упрощённый/традиционный) от 0,04 до 0,20 долларов за слово исходного языка в зависимости многих параметров (формат исходного текста, тематика, необходимость вычитки, тестирования, вид тестирования, ведение глоссариев, консультаций по интернационализации и т.д.)

Альянсы
  Увеличивать/Уменьшать бонус игроку, пропорционально разнице со средним уровнем алла - надо ли?

Duplicate entry '3267-1-60088-1500' for key 'I_unit_player_location_snid'<br />/* tID 155<br />classSupernova::db_upd_record_by_id() - 'includes/db/db_queries_unit.php' Line 50<br />db_unit_set_by_id() - 'modules/unit_captain/unit_captain.php' Line 159<br />(unit_captain)unit_captain->unit_captain_restore_fleet_to_planet() - '' Line <br />call_user_func_array() - 'includes/general.php' Line 32<br />sn_function_call() - 'includes/includes/flt_flying_fleet_handler2.php' Line 22<br />RestoreFleetToPlanet() - 'includes/includes/flt_mission_relocate.php' Line 35<br />flt_mission_relocate() - 'includes/includes/flt_flying_fleet_handler2.php' Line 371<br />flt_flying_fleet_handler() - 'includes/init.php' Line 360<br />require_once() - 'common.php' Line 10<br />require_once() - 'index.php' Line 5<br /> */ UPDATE beta_unit SET `unit_location_type` = 1, `unit_location_id` = 60088 WHERE `unit_id` = 94837<br />

- ПЕРЕДЕЛАТЬ СОВСЕМ
  register_time - это вообще TIMESTAMP! И ПОМЕНЯТЬ В ЗАПРОСЕ НА УДАЛЕНИЕ И НА ОБСЛУЖИВАНИЕ!!!
  player_que - вроде нигде не используется - удалить нахрен
  deltime - нужно только при обслуживании сервера, не работает, можно удалить пока

- СИСТЕМНОЕ
  - ПОСТОЯННАЯ ЧАСТЬ. То, что не изменяется регулярно
    id
    username
    authlevel
    user_as_ally - переделать в user_type: 0 - юзер, 1 - альянс, 2 - бот итд
    ally_id
    id_planet
    galaxy - надо ли держать это в users ???
    system - надо ли держать это в users ???
    planet - надо ли держать это в users ???

  - Переменная часть. Из-за неё, собственно, и лочится таблица USER
    onlinetime
    que_processed

- ЮНИТЫ
  metal
  crystal
  deuterium
  dark_matter
  metamatter
  metamatter_total
  player_race

- СТАТИСТИКА - ОТДЕЛЬНАЯ ЗАПИСЬ В НЕБЛОКИРУЕМОЙ ТАБЛИЦЕ?
  player_rpg_explore_xp
  player_rpg_explore_level
  lvl_minier
  xpminier
  player_rpg_tech_xp
  player_rpg_tech_level
  lvl_raid
  xpraid
  raids
  raidsloose
  raidswin
  total_rank - кэш из статистики?
  total_points - кэш из статистики?


--- СОМНИТЕЛЬНОЕ СИСТЕМНОЕ
  password                  - нужно только при логинах и спецоперациях
  email                     - нужно только при отправке сообщений
  email_2                   - нужно только при отправке сообщений

  ally_tag                  - просто кэширует инфу из Альянса, нахуй надо ???
  ally_name                 - просто кэширует инфу из Альянса, нахуй надо ???

  ally_rank_id              - нужно очень редко
  ally_register_time        - нужно очень редко
  current_planet            - нужно очень редко
  banaday                   - нужно очень редко
  vacation                  - нужно очень редко
  vacation_next             - нужно очень редко


- ПЕРЕМЕННЫЕ
  user_agent   - изменяется только при входе
  user_lastip  - изменяется только при входе
  user_proxy   - изменяется только при входе
  ip_int       - изменяется только при входе
  user_birthday_celebrated  - вообще переменная должна быть

  - Замеры времени
    user_time_measured
    user_time_diff
    user_time_utc_offset
    user_time_diff_forced
  - СООБЩЕНИЯ И НОВОСТИ
    news_lastread
    mnl_alliance
    mnl_joueur
    mnl_attaque
    mnl_spy
    mnl_exploit
    mnl_transport
    mnl_expedition
    mnl_buildlist
    msg_admin
    new_message


- НАСТРОЙКИ
  user_birthday             - нужно очень редко
  sign - подпись в сообщениях. Не участвует нигде
  lang
  sex - gender
  avatar
  dpath
  design
  noipcheck
  options
  planet_sort
  planet_sort_order
  spio_anz
  settings_tooltiptime
  settings_fleetactions
  settings_esp
  settings_wri
  settings_bud
  settings_mis
  settings_rep
  settings_statistics
  settings_info
  admin_protection          - нужно очень редко


Генерация кристаллов

lexa
Первые клеточные автоматы были как раз моделями роста кристаллов (Станислав Улам). Самое известное правило такого автомата - "один из восьми". Ну то есть буквально - новая клетка возникает там, где ровно один живой сосед, в остальных случаях состояние не меняется. Из одной точки вырастает вот такая квадратная снежинка:
http://fuga.ru/shelley/pautina/cell7.gif
Я экспериментировал с чередованием окрестностей, чтобы уйти от квадратности:
http://fuga.ru/shelley/pautina/cell1.gif
Но более натуральные кристаллы -дендриты можно получить иначе: моделируется случайное блуждание с налипанием, тоже на клеточном автомате - но тут есть элемент случайности, потому и картинка более реалистичная:
http://fuga.ru/shelley/pautina/cell13.gif
Вообще там среди иллюстраций Паутины много таких явлений, смоделированных на клеточных автоматах:
http://fuga.ru/shelley/pautina/cell18.gif
Лучшая книжка на эту тему на русском называлась "Машины клеточных автоматов" Тоффоли и Марголуса. Там и все эти правила есть. Впрочем, не исключено, что за последние 20 лет могли еще издать поинтересней. Стивен Вольфрам (который поисковик ВольфрамАльфа) много занимался этой темой тоже.

stealthy_shadow
Я уже дошел до гексагональных снежинок со случайным "налипанием" и фронтальных клеточных автоматов, но результат по-прежнему неудовлетворительный. Хочется получить не просто красивый стационарный кристалл, но и красивую картинку процесса в динамике. Да не монохромную, а с ростом "прожилок", псевдо-трехмерной фактуры и прочих красивостей. Но здесь уже, похоже, нужно конкретное ноу-хау со вполне определенными формулами и сидами

lexa
Ну в общем да, я не специализировался на кристаллах, так что у меня примеры простенькие.
Хотя трехмерные картинки можно получить на трехмерном клеточном автомате точно так же, как на плоском: моделируется случайное блуждение с сохранением числа частиц (то есть окрестность каждой клетки просто вращается в случайную сторону) - ну и дальше налипание.
Можно забавно менять законы налипания. В картинке дендрита, что приведён выше, налипает любая частица, которая оказалась рядом с "замороженной". Но можно задать правило, что на концах снежинки (при одном соседе) вероятность налипания слабая, а вот при двух-трёх побольше. В результате дендриты получаются менее/более разреженные.
Либо вот правило "налипать только на концах" - тогда получаются вообще не дендриты, а паутины:
http://fuga.ru/shelley/pautina/cell10.gif
У меня на сайте валяется старая демка под Винды, там есть и рост дендрита. Правда, она написана для IBM PC 286, для которой это был мультик на полчаса. На современном ноуте она должна пролетать со свистом :)
http://fuga.ru/misc/selfor.com

stealthy_shadow
Да тут бы хотя бы плоские правдоподобные кристаллы получить... Идеи уже закончились - хреново у меня с ними, не идут у меня КА, не вижу я "картинку". Поэтому за предложение поиграться с вероятностью налипания в зависимости от населенности - спасибо.
А вот "жилки" в кристаллах как раз можно сделать дендритами (еще одно "спасибо" за идею). Или просто выделить "поколения" кристаллов и тупо растить один в пределах другого - так что задача получения сложных кристаллов сводится к предыдущей.
А всю эту красоту сгладить и расцветить можно чем-то типа Diamond Square или просто "плазмой" - надо посмотреть по результатам.
В общем - идеи теперь есть, надо с ними поиграться... Спасибо за советы.



CSS и JS - релоадер:
  touch update.php каждый раз
  Вытягивать время изменения апдейта
  Добавлять это время ко всем JS и CSS
  Или просто копировать JS-CSS в каталог cache - но тут нужен центральный репозиторий кэшей и права на запись

Апгрейд офицеров
  Карго-мастер - убрать или повысить ёмкость трюмов. Проверить нужность по статистике использования
  Переделать с повышением цены на трюмы+склады
  Академик - добавить +1 слот/левел. Проверить нужность по статистике использования



Артефакты в экспе - "Премиум" на 1+ дней. Можно хранить, можно использовать для апгрейда

Платежи - переписать централь а-ля иксолла с дефолтным сервером
Проверить работу robots.txt

Center vertically

xsolla - передавать описание платежа

Попереименовывать константы во всех платёжных модулях - привести их к одному стандарту

скин/темплейт console

Переделать платный выбор расы в сброс расы

Статистика
  Проверить, почему при обновлении после удаления данных извне пользователям неправильно назначаются места

Премиум - субсекундная точность. 1 - 0.5 сек, 2 - 0.25 сек, 3 - 0.125 сек итд
  Можно практически всё. Есть в планах - называется "субсекундная точность". Но будет в игре как спец-фишка за ТМ или для высоких уровней премиума - пока не решил, поскольку еще даже не думал над реализацией, поскольку явно неприоритетная вещь, нужная в основном топ- и саб-топам, у которых всё и так более чем кучеряво. Кроме того в сочетании с наниткой на луне - очевидный геймбрейкер: можно моментально наностроителями выкачать нанитку, после чего за считанные часы наклепать неубиваемую оборону. А затем просто свозить ресы на луну и свистеть в три дырочки

[*] Покупка отдельно возможности настраивать меню за ТМ (5к на 1 мес) и навсегда (20кММ)
[*] Вынести весь код, все стили, весь темплейт в menu_customize
Модуль иконок андроида - сделать их системными
Проверить, почему изменения в менюшке отрабатываются только на второй раз
Прикрепленное меню с галочкой "Показывать открепленное меню поверх" так же показывается поверх

Меню
  Сделать глаз больше на мобильных устройствах
  И вообще - делать шрифт больше (?)

Квесты - в меню добавить выполненных/всего

Дальность флота расчитывать по отдельному кораблю - а не по пакам. Что бы не получилось, что пак ЛИ может пролететь 10 галактик, потому что с ними летит пак МТ

Новое лекарство Выапрол

На странице постройки в таблице изменений левела писать +левел +добавки
  Отключать кнопку "Свезти ресурсы", если у игрока только одна планета без луны
  Переделать дропдаун смены ядра
  Покинуть колонию - написать, что это пароль от игры


#chat_message_smiles2 div {
  width: 54px;
  height: 54px;

  -webkit-transform-style: preserve-3d;
  -moz-transform-style: preserve-3d;
  transform-style: preserve-3d;
}
#chat_message_smiles2 div img {
/*  display: inline-block;*/
  position: relative;
  top: 50%;
  -ms-transform: translateY(-51%);
  -webkit-transform: translateY(-51%);
  -o-transform: translateY(-51%);
  -moz-transform: translateY(-51%);
  transform: translateY(-51%);
}



ТУДУ
====
  Видное
  ------
    [*] Чат - выделять цветом, если идет обращение к игроку в сообщении
    [*] Таблицы - выдать "черезполосицу", что бы было можно различать строки легче - в частности при подборе флота
    [*] Премиум - плюс к Губернаторам
    [*] Режим наблюдателя - когда можно летать только между своими планетами и нельзя ничего делать остального
        За ТМ?
        Для прем от 3 (?) давать возможность делать "пассивный" режим?
        С Таймаутом(?)
        Не давать включать при летящих агрессивных флотах


  Важное внутреннее
  -----------------
    [*] Еще раз пройтись по вводу-выводу данных. Это уже когда будет модульная система вывода
    [*] Позаменять везде для ID преобразования из intval() в idval(). ID сделать строкой!


  Быстрое внутреннее
  ------------------


  Завлекалочки
  ------------
    [*] Модуль "Счастливчик" - за ММ повышает всё, что можно
        Серебряная ложка
        Родился в рубашке 10 баксов
        Седьмой сын 100 баксов
        Седьмой сын седьмого сына 1000 баксов
    [*] Модуль "Эвентов"
    [*] ОТДЕЛЬНОЕ СТРОЕНИЕ - ПЛАНЕТАРНЫЙ ЩИТ, который уменьшает всю атаку на некоторое количество единиц
    [*] Модуль "Апгрейдов" - улучшает любой аспект любого юнита
    [*] Артефакт "Планетарный сеятель" - разбрасывает планеты по галактикам. Свои? Чужие?


  Не сломалось - не чини!
  -----------------------
    [*] Ракеты - переписать. Проверить, что бы влияли все бонусы - техи, форты, наемники, премиум
    [*] Альянсы: переписать, в особенности работу с ранками!
    [*] flt_t_send_fleet - переписать и сделать через него отправку всех флотов: своз ресурсов, через подбор флотов, через AJAX
    [*] Флоты - внести в список кораблей флота ресурсы вместо отдельных полей
    [*] // TODO ПЕРЕДЕЛАТЬ! function sys_stat_get_user_skip_list()
    [*] infos.php - переписать
    [*] Вселенная: отправка флотов через AJAX - И ВООБЩЕ РАЗОБРАТЬСЯ, КАК ЭТА ХУЕТА РАБОТАЕТ! И ПЕРЕПИСАТЬ!
    [*] Кэширование языков http://ru.wikipedia.org/wiki/Коды_языков
    [*] Параметр "re" при "cp" вообще не нужен - поубирать везде
    [*] поискать _perhour как в metal_perhour - что бы убрать лишние строки из зданий-факторий
    [*] Ракетные шахты - в строения! +переработка щитов
    [*] Отвязать опции пользователя от пользователя
    [*] Отвязать ресы от планет, флотов, юзера
    [*] Сообщения - бывают "отложенные" и "инстант" - чат и ПМ, например. Переделать отправку сообщений по типам
    [*] Переделать отправку сообщений со стандартного mail() на какой-нибудь мейлер PHPMailer, к примеру. Сделать отправку сообщений пакетами - что бы не попадать в спам-лист
    [*] Отдельный таск КРОНом - или опционально в шедулере
    [*] Добавить в темплейт поддержку префикса Fx_ - форматирование строки, скажем, в целое - FI и в число - FF

  Навороты - ненужное и/или невидимое усложнение
  ----------------------------------------------
    [*] Интеграция с phpBB3 - капча на входе в игру ИЛИ специальные права для зареганных через движок
    [*] Перебалансировать наемников, переделать Академика
    [*] Шпионаж: точность шпионажа от разности уровней для УИШ; защита зондами (?)
    [*] Статистика: сделать еще учет планов и наёмников в стате
    [*] Капитан - скилл для экспы, скилл на ускорение, скилл на сборку ресов
    [*] Диверсификация результатов по экспе:
        - Всегда - ТМ и арты
        - Только транспорты - ресы
        - Только суперхеви - флот
        - Только лайты, миды и хеви - ТМ и арты

  Нутрянное - нужно только мне
  ----------------------------
    [*] ОТКЛЮЧЕНИЕ МОДУЛЯ ДОЛЖНО БЫТЬ ПРОПИСАНО ВО ВСЕХ ФУНКЦИЯХ МОДУЛЯ!
    [*] Плательщики, никогда не закончившие платеж
        SELECT payment_user_id, payment_user_name, max(payment_date), sum(payment_dark_matter_paid)
        FROM game_payment WHERE payment_status <> 1 AND payment_user_id NOT IN (SELECT payment_user_id FROM game_payment WHERE payment_status = 1)
        GROUP BY payment_user_id ORDER BY max(payment_date) DESC
    [*] Бенчмарк. Разделить время обсчета страницы и время генерации собственно HTML-текста

  Фигня всякая, неважная
  ----------------------
    [*] ОШИБКА: проверить - бьется ли get_total_cost($level) с суммой по левелам  НЕ БЬЕТСЯ!!! но совсем чутку // TODO как-нибудь переделать на встроенные циклы
    [*] ОШИБКА: Черный рынок - фигня с обменом ресурсов: не совпадают данные в JS (сколько будет) и в PHP (сколько стало) - очевидно ошибка округления
    [*] Артефакты:
        Инфа с ЧР - в артефакты (?)
        Сканирование удержания - общее количество кораблей на орбите. Возможно - с задержкой по времени


  HyperNova
  ---------
    [*] Сверхбыстрый режим - работа только с xcache - но это только после того, как разберусь с $supernova
    [*] xcache
        Для блокирования записи использовать xcache_inc/xcache_dec:
        xcache_inc = 1 => мы блокировали данную запись, можно работать
        xcache_inc > 1 => запись уже кем-то блокирована, xcache_dec, usleep, повторяем
          usleep — Delay execution in microseconds. A micro second is one millionth of a second.
        Двухуровневая блокировка - на уровне "таблиц" и на уровне "записей". Впрочем, нужна ли блокировка на уровне записей? Может нужна "общая блокировка"
    [*] memcached
        Так же может использоваться Memcache::add()
    [*] HyperNova
        При сохраннении индексов (например - кэш запросов) делать это через implode/explode - потому что всё равно потом прийдется восстанавливать указатели на объекты
        Так же можно для массивов использовать serialize/unserialize и паковать, скажем, gzip - память дешевле тактов
        Индексы можно сворачивать через MD5
    [*] !!!! Поделать мелкие объектики, которые будут инкапсулировать методы и сами следить за своей когерентностью - игроки, планеты, юниты, очереди итд
        Таки да - нативное обращение типа sn->$user->get()
        А дальше уже внутри гета пусть сам ебеться с вытягиванием из базы и блокировкой - или потом как-нибудь? Это же нас к КК не приблизит?


  Ссылкота
  --------
    [*] ioncube http://habrahabr.ru/post/191176/
    [*] http://www.php.net/manual/ru/function.version-compare.php
    [*] http://explainextended.com/2009/10/07/in-list-vs-range-condition-mysql/ - поиск по двум диапазонам
    [*] http://www.smashingmagazine.com/2014/04/24/rebuilding-an-html5-game-in-unity/


    [*] phonegap ручной билд требует только android.permission.INTERNET
        http://www.smashingmagazine.com/2014/02/11/four-ways-to-build-a-mobile-app-part3-phonegap/  пример приложения
        http://propertycross.com/jquerymobile/ пример приложения
        http://tech.pro/blog/1704/2-ways-to-get-started-with-phonegapapache-cordova   пример приложения
        http://habrahabr.ru/post/118059/
        http://stackoverflow.com/questions/14818138/loading-remote-html-in-phonegap-or-cleaver-cordova-on-ios
        http://stackoverflow.com/questions/15343647/using-phonegap-cordova-on-ios-with-external-url
        http://blog.safaribooksonline.com/2012/02/29/phonegap-storing-and-retrieving-with-the-filesystem/
        https://github.com/apache/cordova-plugin-file/blob/master/doc/index.md
        http://docs.phonegap.com/en/1.3.0/phonegap_connection_connection.md.html#Connection - БОЛЕЕ НОВАЯ ВЕРСИЯ НУЖНА!
        http://cordova.apache.org/docs/en/3.0.0/guide_cli_index.md.html#The%20Command-line%20Interface_customize_each_platform настройка вида под разные платформы
        http://www.adamwadeharris.com/android-automation/   build and publish
        http://fusiongrokker.com/post/follow-up-on-phonegap-build-compiled-file-sizes  reduce apk size
        http://www.justbeck.com/three-ways-to-encrypt-phonegap-and-cordova-mobile-applications/
        http://stackoverflow.com/questions/12177134/supporting-multiple-resolution-and-density-of-images-in-phonegap
        http://knockoutjs.com/examples/simpleList.html - MVVM framework в помощь jqmobile
    [*] paypal api http://habrahabr.ru/post/128198/
    [*] google payment
        http://developer.android.com/google/play/billing/gp-purchase-status-api.html
        https://developers.google.com/discovery/libraries
        http://docs.madewithmarmalade.com/display/MD/S3E+Android+Google+Play+Billing%3A+Using+the+API

        http://hashcode.ru/questions/286954/php-как-сделать-закрытый-веб-api-для-андроид-приложения
        https://groups.google.com/forum/#!topic/google-api-php-client/13N4rJ-zT2w
        http://habrahabr.ru/post/160911/
        https://github.com/thetutlage/Google-Play-Store-API
        http://code.google.com/p/google-playstore-api/
        http://grokbase.com/t/gg/android-market-api/1256vwc5js/access-google-play-apps-with-appaware-public-api
    [*] http://rmcreative.ru/blog/post/s-yii-1.1-na-yii-2.0--chast-1-php#comments
        <p>Итак, для перехода на 2.0 стоит изучить:</p>
        <li><a href="http://ru2.php.net/manual/ru/language.namespaces.php">Пространства имён</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/functions.anonymous.php">Анонимные функции</a>.</li>
        <li>Короткий синтаксис массивов. Тут всё просто, вместо <code>array()</code> теперь <code>[]</code>.</li>
        <li>Короткий <code>echo</code> в виде <code>&lt;?=</code>. Доступен всегда. Используется во всех view-шаблонах фреймворка. <a href="http://www.php.net/manual/ru/language.basic-syntax.phptags.php">При этом <code>&lt;?</code> пользоваться, как и ранее, небезопасно</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/book.spl.php">SPL</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/language.oop5.late-static-bindings.php">Позднее статическое связывание</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/book.datetime.php">datetime</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/language.oop5.traits.php">Трейты</a>.</li>
        <li><a href="http://ru2.php.net/manual/ru/book.intl.php">intl</a>. В Yii2 многое из intl завёрнуто в компонент i18n, но не всё.</li>
    [*] force reload
        http://www.w3schools.com/jsref/met_loc_reload.asp
        http://www.stefanhayden.com/blog/2006/04/03/css-caching-hack/
        http://en.wikipedia.org/wiki/Wikipedia:Bypass_your_cache
        http://stackoverflow.com/questions/118884/what-is-an-elegant-way-to-force-browsers-to-reload-cached-css-js-files - заставить браузер перечитывать CSS и JS
    [*] http://www.merzo.net/index.html WELCOME TO STARSHIP DIMENSIONS... A Museum of Speculative Fiction inspired Spaceships
    [*] Рост кристаллов
        https://ru.wikipedia.org/wiki/Фронтальный_клеточный_автомат
        http://www.mat.net.ua/autor/julia01.htm
        http://cyberleninka.ru/article/n/modelirovanie-rosta-dvuhkomponentnogo-kristalla-so-sloistym-raspredeleniem-primesi
        http://www.rsdn.ru/article/livepixels/LivePixels.xml
        http://neoneuro.com/ru/live-pixels-ru/app



    [*] Тексты: реализация "демона максвелла"
        Сколько я помню школьную физику - дальше физика в моей жизни как-то не
        встречалась - отводить придется, поскольку иначе кораблик начнет немного
        сильно греться, там же выполняется работа. А отводить тепло в вакууме
        можно либо просто излучением, либо выкидывая горячее наружу, например по
        принципу демона Максвелла, что, сколько понимаю, вы и предлагаете.

        Проблема с направленным отведением, на мой взгляд, состоит в том, что
        тепло имеет свойство рассеиваться. То есть, мы все равно получим тепловой
        след, причем интенсивность этого следа будет, как минимум, не меньше, чем
        от работающего двигателя, так? Так-то можно было бы просто лететь носом к
        врагам, дюзы-то все равно сзади.

        Допустим, корабль взял с собой запас холода в виде жидкого воздуха - и
        дышать есть чем, и тепло наружу не сбрасывается..

        Я предлагаю не рассеивать горячее вещество, а излучать тепловые лучи. Но
        излучать в одном направлении, окружив горячий радиатор зеркалом. Если
        излучать строго от Солнца - ничего не заметят на его фоне.

        Тепловой след от газа в вакууме почти не образуется, т.к. молекулы быстро
        разлетаются и не сталкиваются.
    [*] Текст: Крисберги - кристалл работает не с сознанием, а с подсознанием
        Аморальный подсознанием
        Поэтому крисберги эффективнее людей с кристаллическими компьютерами - и поэтому же опаснее
        Крисберг - гибрид человека и кристалла, который перешел Предел Человечности
    [*] Текст: Микробиотики - антибиотики из микроботов


РЕЛИЗ 40
========
  [*] mysqli !!!!!!!! ПРОВЕРИТЬ ЕЩЕ РАЗ ВСЕ ВВОДИМЫЕ ДАННЫЕ !!!!!!!

  [*] Инсталлятор
  [*] Апдейтер

  [*] Артефакт: "планетарный телепортер"
  [*] Автоматическая конвертация ТМ в ММ по опции
  [*] Админка - добавить в список игроков начисление ТМ и ММ
  [*] АРТЕФАКТЫ - КУПИТЬ НЕСКОЛЬКО
  [*] ЛОГ ТМ / ММ для игрока
  [*] В ЧР ограничивать количество покупаемых кораблей ресурсами на планете
  [*] todo - в капитане дропнуть поле captain_level - оно всегда равно unit_level
  [*] Ачивки, интегрированные с наградами
  [*] Модуль наград



КК
  [*] Новая характеристика - теплоёмкость. Щиты увеличивают теплоёмкость. Нужно для баланса энергооружия и объема, а так же для использования щитов, а не брони


РЕЛИЗ 39
========
  !!! Сменить лицензионную политику. Модули под ионкубе - см. ссылкоту


  [*] МОДУЛИ: проверить работу
  [%] шпионаж не дает нормальный ID fleet_end_planet_id 'dst_planet'
  [*] Модуль КК
  [*] Модуль квестов "любые награды + мультиусловия"
  [*] Не отсылаются сообщения очередей
  [*] Отключено удаление аккаунта

  [?] Убрать автопополнение стокмана из overview.php. Или, может, оставить? Добавить только rand()
  [*] // FK_referrals_id  'DELETE FROM `{{referrals}}` WHERE `id`             not in (select id from {{users}});',
  [*] // FK_referrals_id_partner  'DELETE FROM `{{referrals}}` WHERE `id_partner`     not in (select id from {{users}});',
  [*] // FK_stats_id_owner  'DELETE FROM {{statpoints}} WHERE stat_type=1 AND id_owner not in (select id from {{users}});',
  [*] БД таблица `unit` индекс I_unit_location - НЕ НУЖЕН, если везде проносить user_id - что, в целом, не сложно, наверное - потому что здоровый очень индекс


  Под вопоросом в 39-м релизе
  ---------------------------
    [*] Переписать ранки Альянсов - кроме ID сделать еще sort_list для упорядочивания без смены ID
    [*] !!!!!!!! GlobalMessage
    [*] !!!!!!!! Переименовать юзеров, планеты, альянсы, тэги в более безопасные - без символов %?"'<>/\[](){};:,.^
    [*] !!!!!!!! В чате - включать пользователям-премиум на месяц и выше разные фишки. Так же включать "бессмертным"

    [*] Отвязать корабли флотов от флотов
    [*] Отвязать губера PLANET_GOVERNOR_ID PLANET_GOVERNOR_LEVEL

    [*] Refactor: change signature - попоменять порядок переменных. Например - mrc_get_level($unit_id, $user, $planet итд)
    [*] рекорды - переписать на отдельную таблицу и что бы обновлялась вместе со статистикой
    [*] Экспы: добавить нахождение Артефактов
    [*] GeoIP - в админке и на странице Императора //todo - проблема с IP - берет IP_v6 - надо настраивать php или апач/lighttpd
    [*] Унифицировать интерфейс постройки/конструирования/исследования
    [*] ДЛЯ РАКЕТ СДЕЛАТЬ ПАРАМЕТР P_CONTAINS_IN - указывать ссылку сооружения, где они могут находиться
    [*] Заменить артефакты строительства/исследования на простое ускорение за ТМ. Добавить ускорение постройки кораблей (?)
    [*] Опция - автоконвертирование ММ в ТМ при нехватке ТМ
    [*] СДЕЛАТЬ ЗДАНИЕ ДЛЯ ОБОРОНЫ - И ПРОВЕРЯТЬ ЕГО НАЛИЧИЕ
    [*] СДЕЛАТЬ РАЗРУШЕНИЕ РАКЕТ - в шахте и в полёте
    [+] Альянсы: лог транзакций
    [*] Проверить поля для ввода данных: ЧР, экраны Альянса - подабавлять мультиэлементы
    [*] ОЧЕРЕДЬ ИССЛЕДОВАНИЯ - расширять академиком
    [*] Констраинт на planets.id_owner => users.id ON UPDATE CASCADE ON DELETE CASCADE - НИХУЯ, ставить в 0 и пусть летять
    [*] Разрешить грабить удалённые планеты и луны тем флотам, что в полете! Проверить, как вообще работает destroyed поле
    [*] Поменять название всем файлам, вызываемым из АЯКСА на ajax_


  Good Enough
    [*] Спасательная капсула - капитан спасается, одноразовая, тыщ 20-30кТМ
    [*] sys_o_get_updated слишком много хочет обновлять подряд юзеров при нескольких планетах - а нада один раз - но эта тока при апдейте
    [*] сеты - доделать
    [*] отложенные ченйджсеты - доделать
    [*] Готовить чейнджсеты - и применять их по _commit, отменять при _rollback
    [*] Паковать чейнджсеты
    [*] Отдетектить updates/delete/replace/insert вне транзакций! И обернуть
    [*] Заменить все обращения к unit - выставлять отдельные флаги, что вынуто ВСЁ
    [*] Заменить все обращения в que - выставлять отдельные флаги, что вынуто ВСЁ
    [*] МОЖНО КЭШИРОВАТЬ ЦЕЛЫМИ ЗАПРОСАМИ!!!! Т.е. get_user_list_by_id(huemoe); - кэшировать. Строить индексы соответствия - апдейтить данные
    [*] SET-функции могут сами в случае нужды запускать транзакции
    [*] переделать позже db_gеt_record_list($location_type, $filter = '')
    [*] НЕ НУЖНО АЛЬЯНС КАЖДЫЙ РАЗ ОБНОВЛЯТЬ!!! сommon.php line 109 and further
    [*] !!! Некоторые групповые запросы не обязательно спускать в БД! Достаточно пройтись и позаменять по кэшу! Все равно если нужно будет что-то не из кэша - его потом можно будет подтянуть!
    [*] Все set_ функции заставить в качестве сета давать список полей а-ля db_prepare_changeset
    [*] В db_changeset_apply - сделать так же изменение соответствующей информации в кэше
    [*] $supernova: оптимизировать количество SQL-запросов
    [*] Всегда приводить емейлы к нижнему регистру!
    [*] Пересчитывать скорости постройки при достройке верфи/нанофабрики
    [*] //todo $fields
    [*] ОБНОВЛЕНИЕ - сделать разбор {{table}} при upd_alter_table
    [*] db_change_units()  // TODO: THIS FUNCTION IS OBSOLETE AND SHOULD BE REPLACED!  // TODO - ТОЛЬКО ДЛЯ РЕСУРСОВ  проверить по модулям  переименовать в db_change_resources()  И вообще избавиться от неё
    [*] Возвращать в пакетах индексы - и уже затем получать инфу по индексам, что бы не засирать память



ФАЗА ? - Админка
================
[!] ВНИИМАНИЕ! ДАННЫЙ ПАТЧ ЯВЛЯЕТСЯ ПРОМЕЖУТОЧНЫМ! В НЁМ НЕ РАБОТАЮТ НЕКОТОРЫЕ ФИШКИ
    В админке отключена "Панель админа" и "Редактирование планеты"
[!] Кстати, сейчас в Верфи и Обороне строится только первое из выбранных сооружений. Забыл написать
[!] Админка
    Отключены: панель админа, компенсация планет - может что-то еще
    В начислении ТМ и ММ поиск производится только по имени пользователя
    Убрана возможность начислять ТМ по планете


  [*] Админка: редактирование планеты: переписать и добавить функционал бесплатного модуля - что бы включался только при наличии хоть какого-нибудь модуля (?)
  [*] Админка: панель админа - переделать
  [*] Админка: компенсацию планет - проверить


ФАЗА ?
======
   [*] интерфейс КК



ФАЗА ?
======
  [*] добавление корпусов и модулей кораблей, балансировка
  [*] Количество залпов в ракете/пушке
  [*] Переделать UBE для поддержки (?) - динамический расчёт данных по амплифай для всех участвующих флотов



ФАЗА ?
======
  [*] перенос $sn_data в БД
  http://php.net/manual/en/function.create-function.php

  [*] Писать в логи если ММ или ТМ меньше 0
  [*] Индексы по новому менеджеру флотов
  [*] Какая-то непонятная хуйня в админке при переключении типа наёмников - проверить
  [*] Имя последнего зарегестрированного пользователя вообще-то надо хранить в конфигурации
  // TODO Заменить на que_tpl_parse_element($que_element); tpl_helpers.php->tpl_parse_planet() 198 и 200
  sys_o_get_updated - разнести, все-таки, процессинг юзеров и юнитов
  [%] Ошибка Статистика - 24:00:00 ошибка, а 24:: - нормально
  [%] Не работает сортировка по размеру планеты! Не учитывает террформер/лунную базу. Сделать отдельное поле для базового стартового количества секторов, максимального и текущего. И вообще разобраться с полями




ФАЗА ? - Интерфейс
==================
НАДО ЕЩЕ ИЗМЕНЯТЬ ДАКМАТТЕР И МЕТАМАТТЕР В КЭШЕ В СООТВЕТСТВУЮЩИХ ПРОЦЕДУРАХ
И вообще - сделать вызов по чейнджсету
А еще лочить всех реферрал-юзеров - что бы не было дедлоков !!! Просто лочить - их данные нам не нужны
По начислению ТМ с рефераллами - тупо блокировать все ИД юзеров, которые есть в таблице реферралов - возможно прийдется сделать сбоку припёку

Юниты - ВЫБИРАТЬ ЮНИТЫ ПО ВРЕМЕНИ! Т.е. что бы наемники действовали на момент боя, например




Для выливания на живой
======================


Текущий билд #45d0#
~~~~~~~~~~~~~~~~~~~~~

// НА ЛОКАЛХОСТЕ ФЛОТЫ ЛЕТАЮТ !!!! Поменять fleet_update_last

Последовательность блокировок user-planet-unit-que-fleet-остальное


Первый дедлок появился в 15692	2014-05-11 19:43:28 - посмотреть, что было сделано между этим временем и 16 часами - когда дедлока еще вроде не было
Если не поможет - добавить предвыборки в двух местах
Если не поможет - включить постоянный лог
По финалу можно сделать SERIALIZABLE
ВРОДЕ ПОМОГЛО
ЛИБО function db_planet_count_by_type($user_id, $planet_type = PT_PLANET) убрал FOR UPDATE
ЛИБО public static function db_transaction_start($level = '') добавил     static::$locator = array(); static::$queries = array();



delete FROM `tst_logs` where log_text like "%Update in progress. Step%";
delete FROM `tst_logs` where log_text like "Running stat updates%";

сделать I_unit_player_location_snid UNIQUE - перед этим почистив таблицу от дубликатов

в настройках сервера сделать редирект - что бы сразу всё отражалось

посмотреть баг в статистике с прасингом данных


сделать бэкап и потереть всё на тесте - оставить только планеты. Потереть ресы на юзерах и их экспириеныс


// todo
Там есть очень хитрый баг, который всплывает только при большом количестве игроков. Надо его отловить


!!! Запустить перевод !!!
1. Перевод локализации:
   0. Допереводить на английский
   1. Оптимизировать локализацию - убрать дубликаты строк (выгрузить всё в БД, собрать из БД список дубликатов, проверить, что дубликаты - это реально дубликаты)
   2. Посчитать количество страниц в переводе - стандартная страница 1860 символов
2. Узнать цены и сроки
   1. На вычитку английского
   2. На перевод
  3. Пока ссуть да тело - пофиксить выпадение языков, т.е. разбить языки на серверный, текущий и контекстный


ОТКЛЮЧИТЬ ЛОГ ЗАПРОСОВ!


Проверить - уменьшаются ли корректно при ракетной атаке:
1. Ракеты - при полном уничтожении атаки (когда интерсепторов больше, чем МПР)
2. Ракеты - при частичном уничтожении атаки (когда интерсепторов меньше, чем МПР)
3. Оборонные сооружения - при прошедшей по планете атаке


Только атмосферные двигатели - требуют наличие еще и межпланетных, иначе корабль не может перелетать между планетами !
Отдельно - атмосферная скорость, космическая скорость, варп-скорость

УМЕНЬШИТЬ ДОХОД ДЕЙТЕРИЕВЫХ ШАХТ! Потому что меньше расход топлива у всех!

Дедлоки:
1. При отправке флота лочить одним запросов юзеров-владельцев планеты-отправления и планеты-назначения - как в свозе, в аяксе и просто при отправке
    16730	2014-05-16 19:18:58
2. Когда лочатся юзеры - лочить и Альянсы! Проверить - как лочаться Альянсы, лочат ли они пользователей
    16873	2014-05-18 20:41:05
    16872	2014-05-18 16:39:22



Из емкости трюма вычитать стоимость топлива для полёта - добавочное поле в таблице fleets


select username, FROM_UNIXTIME(register_time), FROM_UNIXTIME(onlinetime), onlinetime - register_time

delete
from delta_users where onlinetime - register_time  < 60*60 and register_time < UNIX_TIMESTAMP(NOW()) - 24 * 60*60*45
and metamatter_total = 0

Экспа - каждый корабль может утащить только то же количество кораблей своего типа - или больше, если другого

ЮЗЕР в sys_o_get_updated() МОЖЕТ быть пустой, когда идет апдейт УДАЛЕННОЙ планеты - сделать проверку по owner_id планеты

git branch -f branch-b branch-a
Will update branch-b to point to the head of branch-a.

Не показывать рассовые корабли; не показывать корабли других игроков






Добавлять в каждое письмо футер - "Настроить отправку уведомлений на емейл можно в настройках"


Новости - не отсылает уведомление об



Ограничивать дальность видимости с планеты, убрать цену за скан, если еще была. Артефакты, все дела
Отсылка шпиона позволяет открывать планету (?)


Очереди - пересчитывать при постройке нанитки/верфи/лабы/нанолабы - И ПРИ РАЗРУШЕНИИ!
Дописать подсказку для исследований и постройки юнитов/обороны
сделать кнопку замера времени
Показывать день рождения на странице Император


* Посчитаться и расплатиться за отработанный хостинг
* Сделать страничку сбора бабла на КК
* ПейПол
* Оплата через ГугльПлей - КУЧА нюансов и геммора
* Андроид-приложение


Альфа - 2-2-10
Бета - 100-50-500 ???
Гамма - 1-1-1
Дельта - 10000-100-10000


Центрирование модального окна
 jQuery.fn.center = function () {
    this.css("position","absolute");
    this.css("top", ( jQuery(window).height() - this.height() ) / 2+jQuery(window).scrollTop() + "px");
    this.css("left", ( jQuery(window).width() - this.width() ) / 2+jQuery(window).scrollLeft() + "px");
    return this;
  }
 $('#seller_review').show().center();





Премиум - добавлять к левелу хранилищ

Настройка - "предупреждать, если в очереди больше 30 минут постройки текущей прошло"

О! Ценный артефакт - запрет шпионажа
[14:27:20] Project "SuperNova.WS": 30 ТМ (3 бакса) на 24 часа на все планеты


Планеты и луны - приносить ТМ от застройки или спецсзадние (?)  - сбалансировать с ценой сектора
Подарки на ТМ - совочек, грабельки и грузовичок
Добавить пароль на передачу и роспуск Альянса








Хранить хэши пользователей в таблице - аналог сессий. Т.е. кукесы содержат только полностью обезличенную информацию о пользователе
Конвертер старых кукесов
Имперсонация не поддерживается в АПИ
array_replace() - теперь у нас код 5.3.0, поэтому можно использовать вместо своей собственной мерджи или + операций



КЛЮЧ В КОНФИГУРАЦИЮ И НАСТРОЙКА НА set_memory_limit для рассчета статистики!!! Пока - хардкод 256М





Капитаны - прокачка по кораблям: эффективность вождения кораблей, эффективность против


SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0
and onlinetime - register_time < 1 * 60
and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 week);

SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0
and onlinetime - register_time < 10 * 60
and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 2 week);

SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0
and onlinetime - register_time < 15 * 60
and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 3 week);

SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0
and onlinetime - register_time < 60 * 60
and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 month);

SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0
-- and onlinetime - register_time < 60 * 60
and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 month)
and FROM_UNIXTIME(onlinetime) < DATE_SUB(date(now()),INTERVAL 1 month) ORDER BY onlinetime;


SELECT FROM_UNIXTIME(onlinetime), FROM_UNIXTIME(register_time), (onlinetime - register_time)/60, dark_matter, metamatter_total
FROM `game_users` where
metamatter_total = 0 and dark_matter = 0 and (
(onlinetime - register_time < 1 * 60 and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 week))
OR
(onlinetime - register_time < 10 * 60 and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 2 week))
OR
(onlinetime - register_time < 15 * 60 and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 3 week))
OR
(onlinetime - register_time < 30 * 60 and FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 month))
OR
(FROM_UNIXTIME(register_time) < DATE_SUB(date(now()),INTERVAL 1 month) and FROM_UNIXTIME(onlinetime) < DATE_SUB(date(now()),INTERVAL 1 month))
) ORDER BY onlinetime, register_time;






Увеличение очереди за ТМ


Письмо с предложением дружить - ссылка на страницу или описание, как туда попасть





Для админов - попап над каждым ником с общей суммой платежей - через ММ в баксы по курсу


GIF анимация может использовать прозрачность для того чтобы не сохранять очередной кадр целиком, а только изменения относительно предыдущего.
Различные реализации алгоритма Deflate дают разную степень сжатия, поэтому были созданы программы для пережатия изображений с несколькими вариантами настроек в целях получения наилучшего сжатия — например, форк pngcrush OptiPNG и advpng из комплекта AdvanceCOMP (использует 7-Zip).


Показывать стоимость флота при отправке

СТАТИСТИКА - быть экономней с памятью при расчете! Удалять ненужные данные


#ctv  - КК, Фаза 10. Балансировочная

КЛИЕНТ!!!!
Проверка на бан, проверка на отпуск


бронежилет
exoskeleton
powered armor
adaptive armor



https://ardelfi.livejournal.com/137467.html?nc=51#comments
Мотор Эпштейна -- это термоядерный реактор на полностью безнейтронной реации синтеза гелия-3 (³He+³He → 4He+2p+12.86 MeV ). Других вариантов нет, иначе такие корабли были бы несовместимы с жизнью. Даже протон-бор с долями процента энергии в побочных нейтронах убил бы всё живое при гигаваттных мощностях реакторов. Также полностью заряженные продукты реакции дают возможность производства электроэнергии в сравнимых количествах через МГД-генератор, а может и через фотопреобразователь рентгена в электричество. Выхлоп у него конечно плазма, но это не ионный мотор, а термоядерный.
Смотря какие рельсы. Планетарные терранские рельсы, что расстреляли марсианские СЯС где-то на орбите Марса, с подлётным временем на глаз минут пять максимум. Это дальность порядка диаметра орбиты Марса -- 450е6км, значит скорость такого снаряда в пять раз выше скорости света. Вот так я наткнулся на предел реалистичности в Expanse. :) Но допустим снаряд летит полчаса -- это скорость 0.8с, всё ещё много. Потому пусть будет час -- 0.4с, или условный предел реалистичности. Ладно, это планетарные -- огромная машина пуляет небольшой снаряд. Пусть тяжёлые (как у Донаджера) в 10 раз слабее по энергии, средние ещё в 10 раз, лёгкие ещё в 10. Зависимость скорости от энергии квадратична, потому пусть разница в энергии снаряда между планетарным и лёгким рельсотроном будет 1е3, значит в скорости порядка 30. Зависимость там сложнее, потому что у планетарного снаряд кластерный, а у корабельных цельный, но пусть будет 30. В результате, при равных условиях, эффективная дальность лёгкого корабельного рельсотрона будет порядка 15е6км, и если эту дистанцию снаряд преодолеет за полчаса, это 8333км/с. Километров в секунду. С метрами в секунду в Expanse делать нечего -- там ракеты могут долететь из пояса астероидов до Солнца за несколько часом максимум (постоянное ускорение 100ж, или порядка 1км/с², за час даёт скорость 3.6км/с, и подлётное время 35ч; при постоянном ускорении 100ж подлётное время ракеты меньше 6 часов ), а это те же 450е6км, то есть они лишь в разы медленнее снаряда рельсотрона.
C Донаджером у марсианского командира получилась полная жопа. Она думала что самый мощный корабль в системе делает её непобедимой (последние её слова перед самоуничтожением). Она никогда не воевала с равными силами -- на её счету только пираты и подобная мелочь. А в последнем бою она встретилась в равным по технологиями и превосходящим по боевому духу противником, готовым воевать насмерть и жечь свои корабли в атаке. Поэтому контр-атака Донаджера была неправильной. Ракетный залп они пропустили (ядерная ракета попала в двигатель, там видно), а могли сжечь весь залп ракет парой-тройкой своих ракет на траектории перехвата, как потом сделал командир "Роси" в очень неравном бою с терранским крейсером. Дальше, вместо пуляния ракет, марсианский командир должен был сделать два дела одновременно: запустить оба фрегата ("Тахи" и ещё один в ангаре), у которых свои PDC и куча ракет, и началь пулять рельсами с максимальной дистанции -- траектория сближения с противником была выгодна для такой атаки. У марсиан были тяжёлые рельсы, у терранов лёгкие -- марсиане могли выбить все корабли до их выхода на рубеж огня лёгкими рельсами. Вместо этого марсиане вышли на рубеж ракетной атаки, когда в них уже летели десятки ракет. Потом они начали пулять своими тяжёлыми рельсами с рубежа огня лёгкими рельсами противника, которых там было 6 или 7 кораблей -- получилось два рельса против 6 или 7, что предсказуемо закончилось для марсиан повреждениями. В конце концов ни одна из десятков PDC марсиан не расстреляла десантные капсулы терранов, когда они были буквально рядом. Закончилось всё идиотски, практически рукопашной бойней пехоты. Потом, когда началась война, марсиане начали правильно делать, и соотношение потерь было очень в их пользу. Также в эпизоде с потрошением половины марсианского кораблика, порвало его попаданием рельсы, а они даже не знали что там кто-то в них пуляет -- PDC не были активированы. Дальность стрельбы рельсой без коррекции определяется скоростью снаряда, потому тяжёлый рельсотрон качественно превосходит более лёгкий -- может пулять дальше, а дырка такая же.



TODO - ФАЗА 0
todo - сообщение о бане или отпуске
function sn_autologin($abort = true) - переделать вызовы
sys_user_options_unpack($user); - разобраться, где нужно
автогенерация пароля?!
прописать строки локализации
    LOGIN_SUCCESS => '',
    REGISTER_ERROR_USERNAME_WRONG => '',
    REGISTER_ERROR_USERNAME_EXISTS => '',
    REGISTER_ERROR_PASSWORD_INSECURE => '',
    REGISTER_SUCCESS => '',
$skip_ban_check - проверить что и зачем
    // TODO - GLOBAL_MESSAGES
    /*
    //$result = sec_login_username($username_unsafe, $password_raw, sys_get_param_int('rememberme'));
    //$user = $user['user_row'];

    $Message = $lang['thanksforregistry'];
    if(sendpassemail($username, $password, $email))
    {
      $Message .= " (" . htmlentities($email) . ")";
    }
    else
    {
      $Message .= " (" . htmlentities($email) . ")";
      $Message .= "<br><br>{$lang['error_mailsend']} <br /><b>{$password}</b><br />";
    }

    message($Message . $config->adv_conversion_code_register, "{$lang['reg_welldone']}<b>{$password}</b> <script>document.getElementById('sn_navbar').style.display='none';document.getElementById('page_body').style.marginLeft='0px'; document.getElementById('page_body').style.marginTop='0px';jQuery(document).ready(function(){setTimeout(function(){parent.location='overview.php';}, 10000);});</script>");
    */

ВЫНЕСТИ ДОБАВЛЕНИЕ ПОЛЬЗОВАТЕЛЯ ИЗ sec_login_register В ОТДЕЛЬНУЮ ПРОЦЕДУРУ - ИЛИ ЦЕЛИКМО ПЕРЕНЕСТИ КУДА-НИБУДЬ
По таймдиффу тоже всё не очень радостно - посмотреть, может позже его замерять?

ПОЧТОВЫЙ АДРЕС:
1. Логин по почтовому адресу (основному)
2. Проверка при создании почтового адреса - основного и вторичного
3. Проверка при смене почтового адреса - всех адресов
4. Бесплатная смена ника при реге через емайл


При восстановлении пароля - прописывать его сразу в ячейку пароля. Или логиниться сразу?
    $result[F_PASSWORD_NEW] = $new_password;
    $result[F_LOGIN_STATUS] = $operation_result ? PASSWORD_RESTORE_SUCCESS_PASSWORD_SENT : PASSWORD_RESTORE_SUCCESS_PASSWORD_SEND_ERROR;
    $result[F_LOGIN_MESSAGE] = $message . $operation_result ? $lang['log_lost_sent_pass'] : $lang['log_lost_err_sending'];
sec_restore_password_confirm($confirm_safe, $result); - кукесы тут выставлять?


[10.07.2014 22:43:06] Sabretooth> тогда надо описание к Ракетной шахте сменить =)
[10.07.2014 22:43:17] Sabretooth> "С каждым уровнем можно хранить на четыре межпланетных или двенадцать ракет-перехватчиков больше" - как-то не правильно



Переименование планеты - 1кТМ. Или 100 ТМ. Глянуть по системе

[20:29:48 | Изменены 20:30:29] igorrnc Капустьянов Игорь Сергеевич:
http://robertomurray.co.uk/blog/2013/server-side-google-play-in-app-billing-receipt-validation-and-testing/
https://code.google.com/p/android-market-license-verification/
http://habrahabr.ru/post/160911/


































[14:48:02] Project "SuperNova.WS": Механизм подтверждения - это потенциально -50% рег
[14:48:12] Project "SuperNova.WS": Я вообще такой, что автоматом впускать игрока в игру
[14:48:32] igorrnc Капустьянов Игорь Сергеевич: ну после входа уже просить, при определенном действии
[14:48:44] Project "SuperNova.WS": Нажал "Войти" - сгенерировался логин, пароль и в бой
[14:49:35] Project "SuperNova.WS": А чо тебе по рассылке не нравится?
[14:49:39] Project "SuperNova.WS": Возвратов - 7%
[14:49:42] igorrnc Капустьянов Игорь Сергеевич: типа, "хоппа! вы решили колонизировать вторую планету? Ваша империя растёт, и для защиты её от вашей забывчивости давайте ка закрепим секурность почтой!"


[*] SELECT round(year(user_birthday) / 5) * 5, count(*) FROM `game_users` group by round(year(user_birthday) / 5) * 5;
[*] SELECT round(year(user_birthday) / 5) * 5, sum(payment_amount) FROM
    game_payment join
    `game_users` on payment_user_id = id
    where payment_status = 1
    group by round(year(user_birthday) / 5) * 5;

Брандер (нем. Brander) — корабль, нагруженный легкогорючими либо взрывчатыми веществами, используемый для поджога и уничтожения вражеских судов. Мог управляться экипажем, покидавшим судно в середине пути, либо сплавляться по течению или по ветру в сторону вражеского флота.

[*] Подумать еще раз: дейтерий на поддержание флота. По евентам разобрать

[*] Блиц-вселенная: все видят всех

[*] Арена: бои между флотами на заранее заданную сумму

[*] Спиральная галактика - 1 это ядро, остальные - ветки

[*] Покупка отпуска на меньший срок за ТМ

[*] Поправить апдейт, что бы внатуре только админы могли что-то сделать

[*] Добавить НОВОСТИ на все страницы

[*] Чат. Добавить встроенные ББкоде для разделение смайла и имени игрока - пока только в хоронилище

[*] Страница Тёмной Материи - вывести  ссылки  на  все  способы  потратить  ТМ,
    полный динамический список с привязкой к модулям

[*] http://php.net/manual/en/class.splfixedarray.php

[*] !!!!!!!!!!!!!!!!!!!!!!!! http://php.net/manual/en/class.arrayaccess.php
    !!!!! Объект как массив !!!!!!
    $lang, $planet, $user... ДА ВСЁ ПОДРЯД!!!
    И ЮНИТЫ ТАК МОЖНО БУДЕТ ВЫНИМАТЬ ИЗ БД!
    http://stackoverflow.com/questions/2881431/arrayaccess-multidimensional-unset


[*] Вынести поддержку мультикошельковых систем из webmoney в module_payment
    И исправить ошибку: pursue -> purse или вообще wallet

[*] Механизм добавления локализаций для JS-строк - еще посмотреть language

[*] Сделать метаматерию полностью модулем

[*] Конверсия MM -> TM - на странице ТМ


[*] Спасательная капсула для населения

[*] admin_planet_edit_extra - плотность

[*] Переработать констраинты

[*] Добавить в отчет по платежам аллы и фильтр по ним

[*] Считать экспу/левел по факту, а не на странице обзора планеты/император

[*] Награды
    Орден: за Выдаюзиеся Заслуги. Например - спонсорство
    Медаль: за Серьезные Достижения. Например - победа в конкурсе
    Значок - он же "ачивка": "построил 10000 кораблей"
    Памятный знак - за существование и участие. "4 года в игре". "Был онлайн в новогоднюю ночь 2013". итд
    Переходящий вымпел - индикация статуса на сервере: "Топ-1", "Топ", "Сабтоп", "Самый большой флот" итд


[*] Расширенные закладки - добавлять так же состав флота и тип миссии,  что  бы
    отправлять одним-двумя кликами

[*] In Ender's Game, the Formics were like this due to a Hive Mind, and humans compensated by learning how to create instant communication technology.  Ender in fact commented on how the game he was playing was unrealistic because of the instant communication, when unbeknownst to him, it was actually real. Bean realizes the game is real for this very reason in a later book, but never informs others It also does filter through a chain of command, albeit brief, once he started training with his squad leaders. This is usually not a problem. Bean first realizes the truth after an instructor asks him about a book Bean supposedly checked out from the Battle School library involving ancient battle tactics of building multiple layers of defense structures. Bean, having used the book as a cover and only skimmed it (he has eidetic memory, though), tries to justify his interest in it, only to realize that it's nigh-impossible to defend a planet without a truly massive fleet (which the Buggers actually have), so the only viable option to humans is attack.

[*] Сценарии боя - можно задать юнитам порядок убийства и/или обороны

[*] Вернуть рекламу и ссылки на движок/триолан в меню

[*] Сделать выбор расы на экране описания рас

[*] Еще один уровень АКК


[*] Астрофизика
    http://board.ru.ogame.gameforge.com/board494-ogame-ru-игра/board496-энциклопедия/board259-огейм/144947-редизайн/
    http://board.ru.ogame.gameforge.com/board494-ogame-ru-игра/board496-энциклопедия/board262-флоты-и-оборона/52313-всё-о-колониях-и-колонизации/
    http://board.en.ogame.gameforge.com/board1-news/board958-old-news/board959-old-gamenews/537929-redesign-news-reset-and-features/

[*] It's dangerous to go alone! Take this.
[*] There is nothing to see here. Move along!

[*] OpenID/OAuth?: https://github.com/openid/php-openid


[21:07:23] igorrnc Капустьянов Игорь Сергеевич: http://www.tinymce.com/
[21:07:26] igorrnc Капустьянов Игорь Сергеевич: в движок
[21:07:37] igorrnc Капустьянов Игорь Сергеевич: чтобы было выравнивание, встаква урлов и тд.
[21:07:42] Project "SuperNova.WS": НАХУЙ!
[21:08:05] Project "SuperNova.WS": Только - хардкор. Только - bbcode
[21:09:07] igorrnc Капустьянов Игорь Сергеевич: тебе виднее
[21:09:13] igorrnc Капустьянов Игорь Сергеевич: <head><!-- CDN hosted by Cachefly -->
<script src="//tinymce.cachefly.net/4.0/tinymce.min.js"></script>
<script>
        tinymce.init({selector:'textarea'});
</script>
</head>
<body>
        <textarea>Your content here.</textarea>
</body>

[*] Сообщение главе о запросах на дипломатию/смену статуса
[*] rpg_exchange_darkMatter => rpg_exchange_darkmatter
[*] Дневной бонус

[*] «Магическое число семь плюс-минус два» («кошелёк Миллера») — закономерность, обнаруженная американским учёным-психологом Джорджем Миллером, согласно которой кратковременная человеческая память, как правило, не может запомнить и повторить более 7 ± 2 элементов. Эта закономерность была изложена в его работе The Magical Number Seven, Plus or Minus Two: Some Limits on our Capacity for Processing Information, увидевшей свет в 1956 году в Psychological Review.
[*] Меню
    1. Настройка персонального меню - опции по разделам
    2. Свернуть/развернуть по разделам с сохранением опций и восстановлением при рендере
[*] Надо придумать, как отделить шахтеров от рейдеров
[*] Начисление ресурсов за активность (каждый день заход в игру) и за возвращение
[*] Нормальный яваскрипт с биндами на мессджлисте в админке

[*] Поискать $parse, $PageTPL и $RowsTPL - это покажет необработанные страницы. gettemplate(*, false) или без второго параметра, parsetemplate()
[*] admin/overview -> admin/adm_overview
[*] simple_table.tpl.html - ????
[*] .tpl.html => .tpl.php


Идентификация браузера
https://panopticlick.eff.org/index.php?action=log&js=yes


[*] Статистика - медиана
For medians in almost any SQL (assumes (COUNT(*)+1)/2 returns an int, if not then use INT((COUNT(*)+1)/2))
SELECT x.val from data x, data y
GROUP BY x.val
HAVING SUM(SIGN(1-SIGN(y.val-x.val))) = (COUNT(*)+1)/2

[*] readme.txt -> readme.html

[*] Заменить переменные на константы
    define('SN_TIME_NOW', SN_TIME_NOW);


[*] Возможность отключить локальное время
[*] Добавить настройку скорости экспы в админку и в инфу о сервере
[*] Добавить в Утилиты отчет о проделанных действиях
[*] Период полураспада игрока. Период полураспада - хороший показатель интересности игры. Это - интегральная оценка качества аудитории. Надо сделать лог
[*] Экспедиции. Фаза 2 - Астрофизика
    Добавить влияние левела Астрофизики на вариабельность качества ресурсов

[*] Выбор по скока записей на странице в мессджлисте в админке И переделать инпуты-сабмиты в кнопки!


[*] Не производить замер времени, если имперсонейт стоит
[*] Сделать перерасчет статистики сильно чаще
[*] Пенальти в бою при покупке корабля с большими боевыми техами, чем открыто сейчас

[*] Медаль за победу в конкурсе аффилейтов

[*] Чат - неправильное время мьюта
    > у админа надпись неправильная на рожице красенькой - счас время 21:48 - а у него тама до 19:53 - закончилося?

select DATE_FORMAT(payment_date,'%Y-%m'), sum(payment_amount) from game_payment where payment_status = 1 group  by DATE_FORMAT(payment_date,'%Y-%m');a

[*] Не удалять древние акки. Ввести дополнительно в список онлайна параметр активности
[*] Не делать замер времени, если под имперсонейтом!

[*] Супертранспорты - для боя (перебалансить защиту), гипертранспорты - для сейва

[*] Планетарный щит - отключается атакой

[*] Скрипт - собрать всю инфу из архивов об игроках

[*] Реферралка - доработать механизм картинки-реферралки: что бы с миинимальной нагрузкой и подкрепить анализом запросов

статистика - время обновления - не учитывает часовой пояс игрока - не удобно

Разбан за ММ. Сделать доступной страницу бана и покупки ММ

Не удалять старые акки. Добавить новый показатель - активное ядро (количество логинившихся за последнюю неделю)ы

Сделать-таки бэкап по мэинтенансу. Вместе с регулярным мэинтенансом

Отправка флота - подбор флота - риски (ака лейблы, ака черточки) для определения части флота. Плюс кнопка "все"

Краткие названия для построек в очередях типа МИС

В Обзоре Империи сделать ссылку на Новапедию с названий юнитов. И вообще - переверстать со стилями, делегейтами итд итп


SELECT
	date_format(payment_date, '%Y-%m'),
	sum(payment_amount)
FROM
	`game_payment`
WHERE
	payment_status = 1
GROUP BY
	date_format(payment_date, '%Y-%m');


SELECT
	payment_user_id,
	username,
	sum(payment_amount)
FROM
	`game_payment`
LEFT JOIN game_users ON id = payment_user_id
WHERE
	payment_status = 1
AND payment_date >= "2013-09"
GROUP BY
	payment_user_id
ORDER BY
	sum(payment_amount) DESC;

[*] Корабль класса ККК - Командование-Контроль-Коммуникация
    Дает бонус флоту, пока есть хоть один корабль данного типа во флоте
    Много дейтра, много Кристаллов
    Хорошая живучесть - слабая атака
    Капитанский корабль - если хоть один такой корабль был во флоте, то капитан вернется на планету

[*] http://api.yandex.ru/share/doc/dg/concepts/share-button-ov.xml - на логине, на сайтах и в ЗАработай ТМ

[*] Конфигураторы скина: прописывать не только путь к изображениям, но и путь к темплейтам в данных о скине

[*] При чистке безусловно удалять аккаунты, которые выставлены на удаление (?)

Чат - архив чата (?)

Собирать данные геолокации

Звание - "Горец" - в живых должен остаться один - для топ-1. Переходящий вымпел

Памятный знак "тролль"!


Спецдиректива __PATH__ __FILE__ для темплейтов для загрузки относительных файлов

ля чего нужно определять размер окна браузера, для тех случаев когда нам необходимо сделать например резиновый дизайн или чтобы блок целиком закрывал всю область окна браузера
 на jQuery это делается так:
doc_w = $(document).width();
doc_h = $(document).height();
//или
win_w = $(window).width();
win_h = $(window).height();
но если же надо знать размеры каждый раз при ресайзе окна то код будет следующим:
function window_resize(){
var page_h = $("html").height();
var page_h = $("html").width();
}


Радио - давать пользователям набирать свой плейлист. Только премиумам

1. Акки все станут неудаляемыми
2. Будет добавлен новый показатель активности - "игроков в сутки"
3. Будут выставлены новые лимиты на i-шки  и I-шки
4. Будут введены новые правила наследования Альянсов
5. Для зареганых до начала изменения правил - предусмотреть opt-out


Шпионаж таки доделать - и впихнуть левел наемников для++ шпионажа имперского. Уведичить стоимость покупки инфы в Информаторе. Добавить сведения о губере - туда и туда

Апгрейды для Императора - возможность выбирать другие % скорости, т.е. перки
[13:08:46] Project "SuperNova.WS": 1 уровень - 5-10-15-20
2 уровеня - 3-6-9-12
3 уровня - с шагом 1%
4 уровня - с шагом 1% до 110%
[13:09:02] Project "SuperNova.WS": Цены - 25, 50, 100, 200 кТМ

Считать в статистику флоты в сейве


Замер времени - привязать к юзерагенту и ИД компа (который надо присваивать)

Радио - отдельный фрейм, который можно привязать, с элементами управления

Увеличить длину сообщения - свериться с базой

Работа сообщений очереди построек - высылать только тогда, когда полностью закончилась очередь

Перенести админский отчет по платежам в модуль ММ

Состав флота в Удержании должен быть всегда виден хозяину планеты

САБ - сохранять ники и алы игроков и показывать их

Переделать перегрузку через __call... Как?

Губеры - cursor:pointer на ссылку выбора/покупки. + к левелу высвечивать и на обзоре и на покупке. Проверить отработку +к левелу с модуля при индикации - на планетах в обзоре и империи
Губеры - переписать под mrc_get_level. Искать PLANET_GOVERNOR_LEVEL PLANET_GOVERNOR_ID


Привязать макс время экспедиции к количеству экпедиций

админка - вынести просмотр платежей в модуль метаматерии
админка - вынести статистику по юзерам отдельно в модуль

Массовые операции по флотам - только прем-юзерам или по перку или по офицеру

"Совместная оборона" - не отправлять отчёт игрокам, стоящим в "Удержании"

Экспедиции - писать максимальное количество ресов, найденных в экспе (?)


mysql -> mysqli
